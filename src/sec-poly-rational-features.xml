<?xml version="1.0" encoding="UTF-8" ?>
<!-- **********************************************************************-->
<!-- Copyright 2019                                                        -->
<!-- Matthew Boelkins                                                      -->
<!--                                                                       -->
<!-- This file is part of Active Prelude to Calculus.                      -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-SA license.  The work      -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike".  All trademarks are the registered marks of  -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->

<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec-poly-rational-features">
  <title>Key features of rational functions</title>

  <objectives>
  	<ul>
  		<li>
  			<p>
  				What does it mean to say that a rational function has a <q>hole</q> at a certain point, and what algebraic structure leads to such behavior?
  			</p>
  		</li>
  		<li>
  			<p>
  				How do we determine where a rational function has zeros and where it has vertical asymptotes?
  			</p>
  		</li>
  		<li>
  			<p>
  				What does a sign chart reveal about the behavior of a rational function and how do we develop a sign chart from a given formula? 
  			</p>
  		</li>
  	</ul>
  </objectives>

  <introduction>
  	<p>
  		Because any rational function is the ratio of two polynomial functions, it's natural to ask questions about rational functions similar to those we ask about polynomials.  With polynomials, it is often helpful to know where the function's value is zero.  In a rational function <m>r(x) = \frac{p(x)}{q(x)}</m>, as may be expected, we are curious to know where both <m>p(x) = 0</m> and where <m>q(x) = 0</m>.  
  	</p>

  	<p>
  		Connected to these questions, we want to understand both where a rational function's output value is zero, as well as where the function is undefined.  In addition, from the behavior of simple rational power functions such as <m>\frac{1}{x}</m>, we expect that rational functions may not only have horizontal asymptotes (as investigated in <xref ref="sec-poly-rational">Section</xref>), but also vertical asymptotes.  At first glance, these questions about zeros and vertical asymptotes of rational functions may appear to be elementary ones whose answers simply depend on where the numerator and denominator of the rational function are zero.  But in fact, rational functions often admit very subtle behavior that can escape the human eye and the graph generated by a computer.
  	</p>

  	<xi:include href="./previews/PA-poly-rational-features.xml" />

  </introduction>

  <subsection xml:id="subsec-poly-rational-features-hole">
  	<title>When a rational function has a <q>hole</q></title>

  	<p>
  		Two important features of any rational function <m>r(x) = \frac{p(x)}{q(x)}</m> are any zeros and vertical asymptotes the function may have.  These aspects of a rational function are closely connected to where the numerator and denominator, respectively, are zero.  At the same time, a subtle related issue can lead to radically different behavior.  To understand why, we first remind ourselves of a few key facts about fractions that involve <m>0</m>.  Because we are working with a function, we'll think about fractions whose numerator and denominator are approaching particular values.
  	</p>

  	<p>
  		If the numerator of a fraction approaches <m>0</m> while the denominator approaches a nonzero value, then the overall fraction values will approach zero.  For instance, consider the sequence of values
  		<me>
  			\frac{0.1}{0.9} = 0.111111\cdots, \frac{0.01}{0.99} = 0.010101\cdots, \frac{0.001}{0.999} = 0.001001\cdots
  		</me>.
  		Because the numerator gets closer and closer to <m>0</m> and the denominator stays away from <m>0</m>, the quotients tend to <m>0</m>.
  	</p>

  	<p>
  		Similarly, if the denominator of a fraction approaches <m>0</m> while the numerator approaches a nonzero value, then the overall fraction increases without bound.  If we consider the reciprocal values of the sequence above, we see that
  		<me>
  			\frac{0.9}{0.1} = 9, \frac{0.99}{0.01} = 99, \frac{0.999}{0.001} = 999
  		</me>.
  		Since the denominator gets closer and closer to <m>0</m> and the numerator stays away from <m>0</m>, the quotients increase without bound.
  	</p>

  	<p>
  		These two behaviors show how the zeros and vertical asympototes of a rational function <m>r(x) = \frac{p(x)}{q(x)}</m> arise:  where the numerator <m>p(x)</m> is zero and the denominator <m>q(x)</m> is nonzero, the function <m>r</m> will have a zero; and where <m>q(x)</m> is zero and <m>p(x)</m> is nonzero, the function will have a vertical asymptote.  What we must be careful of is the special situation where <em>both</em> the numerator <m>p(x)</m> and <m>q(x)</m> are simultaneously zero.  Indeed, if the numerator and denominator of a fraction both approach <m>0</m>, different behavior can arise.  For instance, consider the sequence
  		<me>
  			\frac{0.2}{0.1} = 2, \frac{0.02}{0.01} = 2, \frac{0.002}{0.001} = 2
  		</me>.  
  		In this situation, both the numerator and denominator are approaching <m>0</m>, but the overall fraction's value is always <m>2</m>.  This is very different from the two sequences we considered above.  In <xref ref="ex-rational-features-hole">Example</xref>, we explore similar behavior in the context of a particular rational function.
  	</p>

  	<example xml:id="ex-rational-features-hole">
  		<statement>
  			<p>
  				Consider the rational function <m>r(x) = \frac{x^2 - 1}{x^2 - 3x - 4}</m> from <xref ref="PA-poly-rational-features">Preview Activity</xref>, whose numerator is <m>p(x) = x^2 - 1</m> and whose denominator is <m>q(x) = x^2 - 3x - 4</m>.  Explain why the graph of <m>r</m> generated by <em>Desmos</em> or another computational device is incorrect, and also identify the locations of any zeros and vertical asymptotes of <m>r</m>.
  			</p>
  		</statement>
  		<solution>
  			<p>
  				It is helpful with any rational function to factor the numerator and denominator.  We note that <m>p(x) = x^2 - 1 = (x-1)(x+1)</m> and <m>q(x) = x^2 - 3x - 4 = (x+1)(x-4)</m>.  The domain of <m>r</m> is thus the set of all real numbers except <m>x = -1</m> and <m>x = 4</m>, the set of all points where <m>q(x) \ne 0</m>.
  			</p>

  			<p>
  				Knowing that <m>r</m> is not defined at <m>x = -1</m>, it is natural to study the graph of <m>r</m> near that value.  Plotting the function in <em>Desmos</em>, we get a result similar to the one shown in <xref ref="F-rational-features-hole-1A">Figure</xref>, which appears to show no unusual behavior at <m>x = -1</m>, and even that <m>r(-1)</m> is defined.  If we zoom in on that point, as shown in <xref ref="F-rational-features-hole-1A-zoom">Figure</xref>, the technology still fails to visually demonstrate the fact that <m>r(-1)</m> is not defined.  This is because graphing utilities sample functions at a finite number of points and then connect the resulting dots to generate the curve we see.
  			</p>

  			<sidebyside>
  				<figure xml:id="F-rational-features-hole-1A">
					<caption>A plot of <m>r(x) = \frac{x^2 - 1}{x^2 - 3x - 4}</m>.</caption>
					<image source="images/rational-features-hole-1A"  />
				</figure>
				<figure xml:id="F-rational-features-hole-1A-zoom">
					<caption>Zooming in on <m>r(x)</m> near <m>x = -1</m>.</caption>
					<image source="images/rational-features-hole-1A-zoom"  />
				</figure>
				<figure xml:id="F-rational-features-hole-1A-zoom-actual">
					<caption>How the graph of <m>r(x)</m> should actually appear near <m>x = -1</m>.</caption>
					<image source="images/rational-features-hole-1A-zoom-actual"  />
				</figure>
  			</sidebyside>

  			<p>
  				We know from our algebraic work with the denominator, <m>q(x) = (x+1)(x-4)</m>, that <m>r</m> is not defined at <m>x = -1</m>.  While the denominator <m>q</m> gets closer and closer to <m>0</m> as <m>x</m> approaches <m>-1</m>, so does the numerator, since <m>p(x) = (x-1)(x+1)</m>.  If we consider values close but not equal to <m>x = -1</m>, we see results in <xref ref="T-r-near-1">Table</xref>.
  			</p>

  			<table xml:id="T-r-near-1">
  				<caption>Values of <m>r(x) = \frac{x^2 - 1}{x^2 - 3x - 4}</m> near <m>x = -1</m>.</caption>
  				<tabular>
  					<row bottom="minor" halign="center">
  						<cell><m>x</m></cell>
  						<cell><m>-1.1</m></cell>
  						<cell><m>-1.01</m></cell>
  						<cell><m>-1.001</m></cell>
  					</row>
  					<row halign="center">
  						<cell><m>r(x)</m></cell>
  						<cell><m>\frac{0.21}{0.51} \approx 0.4118 </m></cell>
  						<cell><m>\frac{0.0201}{0.0501} \approx 0.4012</m></cell>
  						<cell><m>\frac{0.002001}{0.005001} \approx 0.4001</m></cell>
  					</row>
  					<row>
  						<cell></cell>
  						<cell></cell>
  						<cell></cell>
  						<cell></cell>
  					</row>
   					<row bottom="minor" halign="center">
  						<cell><m>x</m></cell>
  						<cell><m>-0.9</m></cell>
  						<cell><m>-0.99</m></cell>
  						<cell><m>-0.999</m></cell>
  					</row>
  					<row halign="center">
  						<cell><m>r(x)</m></cell>
  						<cell><m>\frac{-0.19}{-0.49} \approx 0.3878</m></cell>
  						<cell><m>\frac{-0.0199}{-0.0499} \approx 0.3989</m></cell>
  						<cell><m>\frac{-0.001999}{-0.004999} \approx 0.3999</m></cell>
  					</row> 					
  				</tabular>
  			</table>

  			<p>
  				In the table, we see that both the numerator and denominator get closer and closer to <m>0</m> as <m>x</m> gets closer and closer to <m>-1</m>, but that their quotient appears to be getting closer and closer to <m>y = 0.4</m>.  Indeed, we see this behavior in the graph of <m>r</m>, though the graphing utility misses the fact that <m>r(-1)</m> is actually not defined.  A precise graph of <m>r</m> near <m>x = -1</m> should look like the one presented in <xref ref="F-rational-features-hole-1A-zoom-actual">Figure</xref>, where we see an open circle at the point <m>(-1, 0.4)</m> that demonstrates that <m>r(-1)</m> is not defined, and that <m>r</m> does not have a vertical asymptote or zero at <m>x = -1</m>.
  			</p>

  			<p>
  				Finally, we also note that <m>p(1) = 0</m> and <m>q(1) = -6</m>, so at <m>x = 1</m>, <m>r(x)</m> has a zero (its numerator is zero and its denominator is not).  In addition, <m>q(4) = 0</m> and <m>p(4) = 15</m> (its denominator is zero and its numerator is not), so in this location <m>r(x)</m> has a vertical asymptote.  These features are accurately represented by the original <em>Desmos</em> graph shown in <xref ref="F-rational-features-hole-1A">Figure</xref>.
  			</p>
  		</solution>
  	</example>

	<p>
		In the situation where a rational function is undefined at a point but does not have a vertical asymptote there, we'll say that the graph of the function has a <term>hole</term>.  <idx><h>rational function</h><h>hole</h></idx> In calculus, we use limit notation to identify a hole in a function's graph.  Indeed, having shown in <xref ref="ex-rational-features-hole">Example</xref> that the value of <m>r(x)</m> gets closer and closer to <m>0.4</m> as <m>x</m> gets closer and closer to <m>-1</m>, we naturally write
		<me>
			\lim_{x \to -1} r(x) = 0.4
		</me>
		as a shorthand way to represent the behavior of <m>r</m> (similar to how we've written limits involving <m>\infty</m>). This fact, combined with <m>r(-1)</m> being undefined, tells us that near <m>x = -1</m> the graph approaches a value of <m>0.4</m> but has to have a hole at the point <m>(-1,0.4)</m>, as shown in <xref ref="F-rational-features-hole-1A-zoom-actual">Figure</xref>.  Because we'll encounter similar behavior with other functions, we formally define limit notation as follows.
	</p>

	<definition xml:id="def-rational-limit-finite">
		<statement>
			<p>
				Let <m>a</m> and <m>L</m> be finite real numbers, and let <m>r</m> be a function defined near <m>x = a</m>, but not necessarily at <m>x = a</m> itself.  If we can make the value of <m>r(x)</m> as close to the number <m>L</m> as we like by taking <m>x</m> sufficiently close (but not equal) to <m>a</m>, then we write
				<me>
					\lim_{x \to a} r(x) = L
				</me>
				and say that the limit of <m>r</m> as <m>x</m> approaches <m>a</m> is <m>L</m>.
			</p>
		</statement>
	</definition>

  	<p>
  		The key observations regarding zeros, vertical asymptotes, and holes in <xref ref="ex-rational-features-hole">Example</xref> apply to any rational function.  
  	</p>

  	<assemblage xml:id="asm-rational-zeros-asymptotes-holes">
  		<title>Features of a rational function</title>
 		<p>
 			Let <m>r(x) = \frac{p(x)}{q(x)}</m> be a rational function.
 		</p>

 		<p>
 			<ul>
 				<li>
 					<p>
 						If <m>p(a) = 0</m> and <m>q(a) \ne 0</m>, then <m>r(a) = 0</m>, so <m>r</m> has a zero at <m>x = a</m>.
 					</p>
 				</li>
 				<li>
 					<p>
 						If <m>q(a) = 0</m> and <m>p(a) \ne 0</m>, then <m>r(a)</m> is undefined and <m>r</m> has a vertical asymptote at <m>x = a</m>.
 					</p>
 				</li>
 				<li>
 					<p>
 						If <m>p(a) = 0</m> and <m>q(a) = 0</m> and we can show that there is a finite number <m>L</m> such that
 						<me>
 							\lim_{x \to a} r(x) = L
 						</me>,
 						then <m>r</m> has a hole at the point <m>(a,L)</m>.<fn>It is possible for both <m>p(a) = 0</m> and <m>q(a) = 0</m> and for <m>r</m> to still have a vertical asymptote at <m>x = a</m>.  We explore this possibility further in <xref ref="ez-poly-rational-features-multiplicities">Exercise</xref>.</fn>
 					</p>
 				</li>
 			</ul>
 		</p>
  	</assemblage>

  	<xi:include href="./activities/act-poly-rational-features-ZAH.xml" />

  </subsection>

  <subsection xml:id="subsec-poly-rational-features-signs">
  	<title>Sign charts and finding formulas for rational functions</title>

  	<p>
  		Just like with polynomial functions, we can use sign charts to describe the behavior of rational functions.  The only significant difference for their use in this context is that we not only must include all <m>x</m>-values where the rational function <m>r(x) = 0</m>, but also all <m>x</m>-values at which the function <m>r</m> is not defined.  This is because it is possible for a rational function to change sign at a point that lies outside its domain, such as when the function has a vertical asymptote.
  	</p>

  	<example xml:id="ex-rational-sign-chart">
  		<statement>
  			<p>
  				Construct a sign chart for the function <m>q(x) = \frac{(x-2)(x^2-9)}{(x-3)(x-1)^2}</m>.  Then, graph the function <m>q</m> and compare the graph and sign chart.
  			</p>
  		</statement>
  		<solution>
  			<p>
  				First, we fully factor <m>q</m> and identify the <m>x</m>-values that are not in its domain.  Since <m>x^2-9 = (x-3)(x+3)</m>, we see that
  				<me>
  					q(x) = \frac{(x-2)(x-3)(x+3)}{(x-3)(x-1)^2}
  				</me>.
  				From the denominator, we observe that <m>q</m> is not defined at <m>x = 3</m> and <m>x = 1</m> since those values make the factors <m>x - 3 = 0</m> or <m>(x-1)^2 = 0</m>.  Thus, the domain of <m>q</m> is the set of all real numbers except <m>x = 1</m> and <m>x = 3</m>.  From the numerator, we see that both <m>x = 2</m> and <m>x = -3</m> are zeros of <m>q</m> since these values make the numerator zero while the denominator is nonzero.  We expect that <m>q</m> will have a hole at <m>x = 3</m> since this <m>x</m>-value is not in the domain and it makes both the numerator and denominator <m>0</m>.  Indeed, computing values of <m>q</m> for <m>x</m> near <m>x = 3</m> suggests that
  				<me>
  					\lim_{x \to 3} q(x) = 1.5
  				</me>,
  				and thus <m>q</m> does not change sign at <m>x = 3</m>.
  			</p>

  			<p>
  				Thus, we have three different <m>x</m>-values to place on the sign chart:  <m>x = -3</m>, <m>x = 1</m>, and <m>x = 2</m>.  We now analyze the sign of each of the factors in <m>q(x) = \frac{(x-2)(x-3)(x+3)}{(x-3)(x-1)^2}</m> on the various intervals.  For <m>x \lt -3</m>, <m>(x-2) \lt 0</m>, <m>(x-3) \lt 0</m>, <m>(x+3) \lt 0</m>, and <m>(x-1)^2 \gt 0</m>.  Thus, for <m>x \lt -3</m>, the sign of <m>q</m> is
  				<me>
  					\frac{- - -}{- +} = +
  				</me>
  				since there are an even number of negative terms in the quotient.
  			</p>

  			<p>
  				On the interval <m>-3 \lt x \lt 1</m>, <m>(x-2) \lt 0</m>, <m>(x-3) \lt 0</m>, <m>(x+3) \gt 0</m>, and <m>(x-1)^2 \gt 0</m>.  Thus, for these <m>x</m>-values, the sign of <m>q</m> is 
  				<me>
  					\frac{- - +}{- +} = -
  				</me>.
  			</p>

  			<p>
  				Using similar reasoning, we can complete the sign chart shown in <xref ref="F-ex-rational-sign-chart">Figure</xref>.  A plot of the function <m>q</m>, as seen in <xref ref="F-ex-rational-plot">Figure</xref>, shows behavior that matches the sign function, as well as the need to manually identify the hole at <m>(3, 1.5)</m>, which is missed by the graphing software.
  			</p>

  			<sidebyside valign="middle">
  				<figure xml:id="F-ex-rational-sign-chart">
  					<caption>The sign chart for <m>q</m>.</caption>
  					<image source="images/rational-sign-chart" />
  				</figure>
  				<figure xml:id="F-ex-rational-plot">
  					<caption>A plot of <m>q</m>.</caption>
  					<image source="images/rational-plot-ex" />
  				</figure>
  			</sidebyside>

  			<p>
  				In both the sign chart and the figure, we see that <m>q</m> changes sign at each of its zeros, <m>x = -3</m> and <m>x = 2</m>, and that it does not change as it passes by its vertical asymptote at <m>x = 1</m>.  The reason <m>q</m> doesn't change sign at the asympotote is because of the repeated factor of <m>(x-1)^2</m> which does not change sign.
  			</p>
  		</solution>
  	</example>

  	<p>
  		To find a formula for a rational function with certain properties, we can reason in ways that are similar to our work with polynomials.  Since the rational function must have a polynomial expression in both the numerator and denominator, by thinking about where the numerator and denominator must be zero, we can often generate a formula whose graph will satisfy the desired properties.
  	</p>

	<xi:include href="./activities/act-poly-rational-formula.xml" />

  </subsection>

  <subsection xml:id="subsec-poly-rational-features-summary">
  	<title>Summary</title>
  	<ul>
  		<li>
  			<p>
  				If a rational function <m>r(x) = \frac{p(x)}{q(x)}</m> has the properties that <m>p(a) = 0</m> and <m>q(a) = 0</m> and 
 				<me>
 					\lim_{x \to a} r(x) = L
 				</me>,
 				then <m>r</m> has a hole at the point <m>(a,L)</m>.  This behavior can occur when there is a matching factor of <m>(x-a)</m> in both <m>p</m> and <m>q</m>.
  			</p>
  		</li>
  		<li>
  			<p>
  				For a rational function <m>r(x) = \frac{p(x)}{q(x)}</m>, we determine where the function has zeros and where it has vertical asymptotes by considering where the numerator and denominator are <m>0</m>.  In particular, if <m>p(a) = 0</m> and <m>q(a) \ne 0</m>, then <m>r(a) = 0</m>, so <m>r</m> has a zero at <m>x = a</m>.  And if <m>q(a) = 0</m> and <m>p(a) \ne 0</m>, then <m>r(a)</m> is undefined and <m>r</m> has a vertical asymptote at <m>x = a</m>.
  			</p>
  		</li>
  		<li>
  			<p>
  				By writing a rational function's numerator in factored form, we can generate a sign chart for the function that takes into account all of the zeros and vertical asymptotes of the function, which are the only points where the function can possibly change sign.  By testing <m>x</m>-values in various intervals between zeros and/or vertical asymptotes, we can determine where the rational function is positive and where the function is negative. 
  			</p>
  		</li>
  	</ul>
  </subsection>

  <xi:include href="./exercises/ez-poly-rational-features.xml" />

  <!-- <xi:include href="./activities/act-1-1-1.xml" /> -->
  <!-- <xi:include href="./exercises/ez-1-1.xml" /> -->
</section>

